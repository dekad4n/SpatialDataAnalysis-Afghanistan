"0",""
"0","afghanistan_df <- st_as_sf(afghanistan_shp)"
"0",""
"0","# Convert to spatial points dataframe"
"0","afghanistan_conflicts <- st_as_sf(afghanistan_conflicts, coords = c(""longitude"", ""latitude""))"
"0",""
"0","# Set CRS for afghanistan_conflicts to match afghanistan_df"
"0","st_crs(afghanistan_conflicts) <- st_crs(afghanistan_df)"
"0",""
"0","# Merge data with the shapefile based on admin1 column"
"0","merged_data <- st_join(afghanistan_df, afghanistan_conflicts, join = st_intersects)"
"0",""
"0","# Calculate the average civilian targeting for each administrative boundary"
"0","averages <- merged_data %>%"
"0","  group_by(name) %>%"
"0","  mutate(civilian_targeting = ifelse(civilian_targeting == ""Civilian targeting"", 1, 0)) %>%"
"0","  summarize(avg_civilian_targeting = mean(civilian_targeting))"
"0",""
"0","afghanistan_df <- as.data.frame(afghanistan_df)"
"0",""
"0","# Merge the averages data back into the spatial data"
"0","afghanistan_df <- merge(afghanistan_df, averages, by = ""name"")"
"0",""
"0","# Convert back to a spatial object"
"0","afghanistan_df <- st_as_sf(afghanistan_df)"
